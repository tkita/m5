<!DOCTYPE html>
<html>
    <head>
	<meta charset="UTF-8">

	<script>
	 function getNearStation ( lat, lng ) {
	     var result = objStations.map( function ( s ) {
		 var h1 = Math.abs( lat - s[2] );
		 var h2 = Math.abs( lng - s[3] );
		 return { id: s[0],
			  name: s[1],
			  dist: h1 * h1 + h2 * h2 };
	     });
	     result.sort( function ( a, b ) {
		 if ( a.dist < b.dist ) return -1;
		 if ( a.dist > b.dist ) return 1;
		 return 0;
	     });
	     return result.slice( 0, 5 ); // 上位５つ
	 }

	 function start () {
	     // 西区役所
	     console.info( getNearStation( 43.074358,141.300899 ) );
	     // 北区役所
	     console.info( getNearStation( 43.090691,141.340922 ) );
	 }

	 function searchShokuba () {
	     var kword = document.getElementById( "kword" ).value;
	     var keys = Object.keys( objWorkplace );
	     var result = [];
	     keys.forEach( function ( p ) {
		 objWorkplace[ p ].forEach( function ( s ) {
		     if ( s.indexOf( kword ) > -1 ) {
			 result.push( s );
		     }
		 });
	     });
	     console.info( result );
	 }
	</script>
    </head>

    <body>
	<button onClick="start();">start</button>

	<div>
	    <input type="text" id="kword" size="40">&nbsp;<button onClick="searchShokuba();">検索</button>
	</div>
	<script type="text/jscript" src="./objwp.js"></script>
	<script type="text/jscript" src="./objStations.js"></script>
    </body>
</html>
