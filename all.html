<!DOCTYPE html>
<html>
    <head>
	<meta charset="UTF-8">
	<!-- <meta http-equiv="X-UA-Compatible" content="IE=11" /> -->
	<meta name="viewport"
	      content="width=device-width, initial-scale=1.0, minimum-scale=1.0" />
	<title>m5</title>

	<style>
	 .gm-style > div > div > div > div > div > div {
	     opacity: 0.7;
	 }
	</style>

	<script>
	 var opener = window.dialogArguments;

	 function makeMarker( map, lat, lng, image, opt_msg ) {
	     var marker = new google.maps.Marker(
		 { map: map,
		   position: new google.maps.LatLng( lat, lng ),
		   icon: new google.maps.MarkerImage( image )
		 } );
	     if ( opt_msg ) {
		 google.maps.event.addListener( marker, 'click',
						function( event ) {
						    new google.maps.InfoWindow( { content: opt_msg } ).
							       open( marker.getMap(), marker );
						});
	     }
	     return marker;
	 }

         function init () {
             var options = { center: new google.maps.LatLng( '43.061945', '141.354395' ),
                             panControl: false,
                             scaleControl: true,
                             zoomControlOptions: { style: google.maps.ZoomControlStyle.SMALL },
                             zoom: 12,
                             mapTypeId: google.maps.MapTypeId.ROADMAP
             };
             var map = new google.maps.Map( document.getElementById( 'all_map' ), options );

	     // main

	     var markerColor = {
		 '10': 'red', // 代表
		 '11': 'red', // 総務局
		 '12': 'red', // 財政局
		 '13': 'red', // 市民文化局
		 '14': 'red', // 経済観光局
		 '15': 'red', // スポーツ局
		 '16': 'red', // 保健福祉局
		 '17': 'red', // 子ども未来局
		 '18': 'red', // ちあふる
		 '19': 'red', // 保育園
		 '20': 'red', // 環境局
		 '21': 'red', // 建設局
		 '22': 'red', // 下水道河川局
		 '23': 'red', // 交通局
		 '24': 'red', // 水道局
		 '25': 'red', // 市立札幌病院
		 '26': 'red', // 消防局
		 '27': 'red', // 土木センター
		 '28': 'red', // まちセン
		 '29': 'red', // 教育委員会
		 '30': 'red', // 図書館
		 '31': 'red', // 小学校
		 '32': 'red', // 中学校
		 '33': 'red', // 高等学校
		 '34': 'red', // 中等教育学校
		 '35': 'red', // 特別支援学校
		 '36': 'red', // 幼稚園
		 '37': 'green', // 地下鉄
		 '38': 'green', // ＪＲ駅
	     };

             Object.keys( objWorkplace ).forEach( function ( key ) {
		 var image = 'https://tkita.github.io/m5/resources/mm_20_' +
			     markerColor[key] + '.png';
                 objWorkplace[ key ].data.forEach( function ( data ) {
		     var name = data.split( ',' )[0]
		     var build = data.split( ',' )[1]
		     var addr = data.split( ',' )[2]
                     var lat = data.split( ',' )[3]
                     var lng = data.split( ',' )[4]
                     // console.info( lat, lng );
		     var marker = makeMarker( map, lat, lng, image,
					      name + '<br>' + build + '<br>' + addr );
                 });
             });
         }

        </script>

        <style>
         #all_map {
             width: 800px;
             height: 800px;
         }
        </style>
    </head>

    <body>
        <div id="all_map"></div>
	<script type="text/jscript" src="./data/objwp.js"></script>
	<script type="text/jscript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC78j0reQqOofNHQxsINRTt21UgyVK1MTo&libraries=geometry&callback=init"></script>
    </body>
</html>
